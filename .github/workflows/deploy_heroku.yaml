name: Deploy

on:
  pull_request:
    branches: [ development ]

jobs:
  deploy:
    name: Deploy to Heroku
    runs-on: ubuntu-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v2

    - name: Deploy
      uses: akhileshns/heroku-deploy@v3.12.12
      with:
        heroku_api_key: ${{secrets.X_HEROKU_DEPLOY_KEY}}
        heroku_app_name: "vision-demo-app"
        heroku_email: "rori.development@gmail.com"
        usedocker: true
        stack: "container"
      env:
        HD_APP_HOST: "vision-demo-app.herokuapp.com"
        HD_APPROVER_EMAIL: "visionopensource2021@gmail.com"
        HD_CONTACT_EMAIL: "visionopensource2021@gmail.com"
        HD_ENTITY_SOURCES: "engineering,qa,devops"
        HD_LANG: "en_US.UTF-8"
        HD_RAILS_ENV: "staging"
        HD_RAILS_LOG_TO_STDOUT: "true"
        HD_RAILS_SERVER_STATIC_FILES: "enabled"
        HD_TZ: "Asia/Jakarta"
        HD_VALID_EMAIL: "gmail.com"
        HD_VISION_EMAIL: "visionopensource2021@gmail.com"
